<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>화도쿠</title>
    
    <!-- PWA 및 모바일 최적화 -->
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="화도쿠">
    <link rel="apple-touch-icon" href="/favicon.png">

    <link rel="stylesheet" href="/src/css/base.css" />
    <link rel="stylesheet" href="/src/css/layout.css" />
    <link rel="stylesheet" href="/src/css/animations.css" />
    <link rel="stylesheet" href="/src/css/main-menu.css" />
    <link rel="stylesheet" href="/src/css/sudoku-board.css" />
    <link rel="stylesheet" href="/src/css/controls.css" />
    <link rel="stylesheet" href="/src/css/components.css" />
    <link rel="stylesheet" href="/src/css/modals.css" />
    <link rel="stylesheet" href="/src/css/responsive.css" />
    <link rel="icon" href="/favicon.png" type="image/png" />
  </head>
  <body>
    <header>
      <h1></h1>
    </header>
    <p id="random-passage"></p>

    <main>
      <div id="main-menu-screen">
        <!-- Position 1: Achievement Button -->
        <div class="sudoku-block-menu-item" data-menu-id="achievement">
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
        </div>
        <!-- Position 2: Placeholder (was pos 7) -->
        <div class="sudoku-block-menu-item">
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
        </div>
        <!-- Position 3: settings (was pos 3) -->
        <div class="sudoku-block-menu-item" data-menu-id="settings">
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
        </div>
        <!-- Position 4: Placeholder (was pos 8) -->
        <div class="sudoku-block-menu-item">
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
        </div>
        <!-- Position 5: logo (was pos 5) -->
        <div class="sudoku-block-menu-item" data-menu-id="logo">
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
        </div>
        <!-- Position 6: difficulty (was pos 1) -->
        <div class="sudoku-block-menu-item" data-menu-id="difficulty">
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
        </div>
        <!-- Position 7: info (was pos 6) -->
        <div class="sudoku-block-menu-item" data-menu-id="info">
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
        </div>
        <!-- Position 8: topic (was pos 2) -->
        <div class="sudoku-block-menu-item" data-menu-id="topic">
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
        </div>
        <!-- Position 9: start (was pos 9) -->
        <div class="sudoku-block-menu-item" data-menu-id="start">
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
          <div class="menu-sub-cell"></div><div class="menu-sub-cell"></div><div class="menu-sub-cell"></div>
        </div>
      </div>

            <div id="score-display" class="hidden">
              <button id="main-menu-btn"></button>

              <!-- NEW High Score Structure -->
              <div class="score-section" id="high-score-display">
                <img id="high-score-rank-image" src="/public/images/ranks/rank1.png" alt="최고 점수 랭크" />
                <div class="score-text-group">
                  <span class="score-label">최고점수</span>
                  <span id="high-score-value" class="score-value">0</span>
                </div>
              </div>

              <!-- NEW Current Score Structure -->
              <div class="score-section" id="current-score-display">
                <div class="score-text-group">
                  <span class="score-label">현재점수</span>
                  <span id="current-score-value" class="score-value">0</span>
                </div>
                <img id="current-score-rank-image" src="/public/images/ranks/rank1.png" alt="현재 점수 랭크" />
              </div>

              <button id="retry-game-btn"></button>
            </div>

      <div id="sudoku-board" class="hidden"></div>
      <div id="stage-page-navigation" class="hidden">
        <button id="prev-stage-page-btn">◀</button>
        <button id="next-stage-page-btn">▶</button>
      </div>
      
      <div id="game-controls-wrapper">
        <div id="jokbo-display-container" class="hidden">
            <!-- Jokbo count cells will be rendered here -->
        </div>

        <div id="hint-container" class="hidden">
          <button id="use-hint-btn"><span id="hint-count">0</span></button>
        </div>
      </div>



      <div id="jokbo-rules-modal" class="hidden">
        <div id="jokbo-rules-content">
          <h2>족보 규칙</h2>
          <div id="jokbo-rules-grid"></div>
          <button id="jokbo-rules-close-btn">닫기</button>
        </div>
      </div>

      <div id="rank-modal" class="hidden">
        <div id="rank-content">
          <h2>랭크 정보</h2>
          <div id="rank-grid"></div>
          <button id="rank-close-btn">닫기</button>
        </div>
      </div>

      <div id="completion-modal" class="hidden">
        <div id="completion-content">
          <div id="completion-score"></div>
          <div id="completion-details"></div>
          <button id="completion-close-btn">닫기</button>
        </div>
      </div>

      <div id="high-score-modal" class="hidden">
        <div id="high-score-content">
          <h2>최고 점수 TOP 10</h2>
          <table>
            <thead>
              <tr>
                <th>순위</th>
                <th>점수</th>
                <th>난이도</th>
                <th>날짜</th>
              </tr>
            </thead>
            <tbody id="high-score-table-body">
              <!-- 점수 내역이 여기에 동적으로 추가됩니다 -->
            </tbody>
          </table>
          <button id="high-score-close-btn">닫기</button>
        </div>
      </div>

      <div id="help-modal" class="hidden">
        <div id="help-content" class="highlight-guide">
          <h2>도움말</h2>
          <p><strong>화도쿠(Whadoku)</strong>는 스도쿠와 화투의 족보 시스템을 결합한 게임입니다.</p>
          <h3>기본 규칙</h3>
          <ul>
            <li>가로, 세로, 3x3 블록에 1부터 9까지의 숫자를 겹치지 않게 채워주세요.</li>
            <li>숫자를 맞히면 점수를 얻고, 틀리면 감점됩니다.</li>
          </ul>
          <h3>족보 시스템</h3>
          <ul>
            <li>가로줄, 세로줄, 3x3 블록 단위로 화투 족보가 완성되면 추가 점수를 얻습니다.</li>
            <li>족보의 종류와 점수는 '족보' 버튼을 통해 확인할 수 있습니다.</li>
          </ul>
          <p></p>

          <button id="help-close-btn">닫기</button>
        </div>
      </div>
    </main>

    <div id="info-modal" class="hidden">
      <div id="info-content">
        <h2>화도쿠 정보</h2>
        <p>버전: 1.0.0</p>
        <p>개발: Gemini Agent</p>
        <p>아이디어: 공작왕님</p>
        <p>오픈소스 라이선스: MIT</p>
        <button id="info-close-btn">닫기</button>
      </div>
    </div>

    <!-- Topic List Modal -->
    <div id="topic-list-modal" class="hidden">
      <div id="topic-list-content">
        <div id="topic-buttons-container">
          <ul id="topic-list">
            <!-- Topic buttons will be dynamically loaded here -->
          </ul>
        </div>
        <div id="passage-display-area">
          <!-- Passages for the selected topic will be displayed here -->
        </div>
        <button id="topic-list-close-btn">닫기</button>
      </div>
    </div>

    <!-- Collection Modal (저장된 글귀 목록 모달) -->
    <div id="collection-modal" class="hidden">
      <div id="collection-content">
        <h2>저장된 글귀 목록</h2>
        <div id="collection-list-container">
          <ul id="collection-list">
            <!-- Saved passages will be dynamically loaded here -->
          </ul>
        </div>
        <button id="collection-close-btn">닫기</button>
      </div>
    </div>

    <!-- Pause Modal -->
    <div id="pause-modal" class="hidden">
      <div id="pause-content">
        <h2>일시정지</h2>
        <div class="pause-options">
          <button id="resume-game-btn">계속하기</button>
          <button id="quit-to-main-btn">메인으로</button>
        </div>
      </div>
    </div>

    <!-- Blog Promotion Bonus Modal -->
    <div id="blog-bonus-modal" class="hidden">
      <div id="blog-bonus-content">
        <div class="bonus-header">🎁 보너스 힌트 획득!</div>
        <div class="blog-banner-container">
          <!-- 실제 이미지가 있다면 src를 수정하시면 됩니다. 현재는 임시 텍스트 배너 -->
          <div class="temp-banner-img">
            <span class="banner-title">공작왕의 블로그</span>
            <span class="banner-url">blog.naver.com/lnogardl</span>
          </div>
          <img id="blog-actual-banner" src="" alt="블로그 홍보 배너" class="hidden" />
        </div>
        <p class="bonus-wait-msg">잠시 후 힌트가 1개 충전됩니다... (5초)</p>
      </div>
    </div>

    <div id="mini-palette" class="hidden"></div>

    <script type="module" src="/src/js/main.js"></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js').then((registration) => {
            console.log('SW registered');
          }).catch((err) => {
            console.log('SW registration failed', err);
          });
        });
      }
    </script>
    <audio id="click-sound" src="/public/sounds/click.mp3"></audio>
    <audio id="error-sound" src="/public/sounds/error.mp3"></audio>
    <audio id="f5-sound" src="/public/sounds/f5.mp3" preload="auto"></audio>
    <audio id="jokbo-sound" src="/public/sounds/jokbo.mp3"></audio>
    <audio id="sound-samkwang" src="/public/sounds/jokbo_samkwang.mp3"></audio>
    <audio id="sound-godori" src="/public/sounds/jokbo_godori.mp3"></audio>
    <audio id="sound-hongdan" src="/public/sounds/jokbo_hongdan.mp3"></audio>
    <audio id="sound-chungdan" src="/public/sounds/jokbo_chungdan.mp3"></audio>
    <audio id="sound-chodan" src="/public/sounds/jokbo_chodan.mp3"></audio>
    <audio id="sound-tti" src="/public/sounds/jokbo_tti.mp3"></audio>
    <audio id="sound-kkut" src="/public/sounds/jokbo_kkut.wav"></audio>
    <footer>
      <p>■ 2025 WHADOKU ■</p>
    </footer>
  </body>
</html>
